#!/usr/bin/env bash

export __GL_THREADED_OPTIMISATIONS=1

# Maybe start this daemon
run() {
    command -v "$1" >/dev/null || return
    pgrep "$1" >/dev/null || $@
}

# failsafe
{
    sleep 5

    # If sxhkd isn't running by now something is wrong and we're stuck, so open
    # a terminal so I can do something about it
    pgrep sxhkd >/dev/null || termite &
} &

# mouse acceleration
xset m 11/8 0
# keyboard repeat rate
xset r rate 350 45

# set wallpaper
run feh --no-fehbg --image-bg black --bg-center "$HOME/pictures/wallpaper"

# essentials
run sxhkd &      # keyboard daemon
run dunst &      # notifications
run compton &    # perdy effects + transparency

# non-essentials
run mpd &           # music server
run redshift &      # screen temperature based on time-of-day
$HOME/.bin/rsl.sh   # resilio sync

